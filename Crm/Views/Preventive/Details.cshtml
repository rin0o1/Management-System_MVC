@using Crm_DataUtilities.ViewModel;
@using Crm_Global;

@model PreventiveDetailsViewModel
@{
    PageParameters _pageParameters = ViewBag.pageParameters;
    var controllerName = _pageParameters.ControllerName;
    var actionName = "Details";
}
    <div class="crm-detailspage">

        <input type="hidden" id="_ControllerName" name="ControllerName" value="@controllerName">

        <div class="index-header">
            <span class="index-title no-padding  "> @_pageParameters.PageTitle </span>
        </div>

        <input type="hidden" id="IdOfThisElement" value="@Model.IdPreventivo">

        
            @using (Html.BeginForm(actionName, controllerName, FormMethod.Post, new { id = "Form_" }))
            {
                @Html.AntiForgeryToken()
                <input type="hidden" name="IdPreventivo" value="@Model.IdPreventivo">

                <div class="form-group">


                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-3">
                                <div>
                                    <label class="col-sm-12">
                                        Numero Preventivo
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12 ImportantData" type="text" name="NumeroPreventivo" value="@Model.NumeroPreventivo">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div>
                                    <label class="col-sm-12">Data</label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="text" name="Data" value="@Model.Data">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div>
                                    <label class="col-sm-12">Durata</label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="text" name="Durata" value="@Model.Durata">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div>
                                    <label class="col-sm-12">Listino in vigore</label>
                                </div>
                                <div>
                                    <input class="col-sm-12 chg " type="number" min="0" name="ListinoInVigore" value="@Model.ListinoInVigore">
                                </div>
                            </div>
                        </div>
                    </div>

                    <br />

                    <div class="form-group">
                        <div class="row  SomeSpaceTop">
                            <div class="col-md-2 LineBOt">
                                <label> Oggetto</label>
                            </div>
                            <input class="col-md-10" type="text" name="Oggetto" value="@Model.Oggetto">
                        </div>
                        <br />
                        <div class="row SomeSpaceTop">
                            <div class="col-md-2 LineBOt">
                                <label> Riferimento </label>
                            </div>
                            <input class="col-md-10" type="text" name="Riferimento" value="@Model.Riferimento">
                        </div>
                        <br />
                        <div class="row  SomeSpaceTop">
                            <div class="col-md-2 LineBOt">
                                <label> Allegati </label>
                            </div>
                            <input class="col-md-10" type="text" name="Allegati" value="@Model.Allegati">
                        </div>
                        <br />
                        <div class="row SomeSpaceTop ">
                            <div class="col-md-2 LineBOt">
                                <label> Progetto </label>
                            </div>
                            <input class="col-md-10" type="text" name="Progetto" value="@Model.Progetto">
                        </div>
                    </div>

                    <br />
                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-6">
                                <div>
                                    <label class="col-sm-12">
                                        Attenzione di
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="text" name="Attenzione" value="@Model.Attenzione">
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div>
                                    <label class="col-sm-12">
                                        Operatore
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="text" name="Operatore" value="@Model.Attenzione">
                                </div>
                            </div>
                        </div>
                    </div>

                    <br />

                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-4">
                                <div>
                                    <label class="col-sm-12">
                                        Addebito trasporto
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12 " type="text" name="AddebitoTrasportato" value="@Model.AddebitoTrasportato">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div>
                                    <label class="col-sm-12">
                                        Pagemento
                                    </label>
                                </div>
                                <div class="CustomSelectionItem ">
                                    <select class="col-sm-12 SelectionItem" id="country" name="Pagamento">
                                        <option> @Model.Pagamento</option>
                                        <option> DA CONCORDARE </option>
                                        <option> EFFETTUATO </option>
                                        <option> NON EFFETTUATO </option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div>
                                    <label class="col-sm-12">
                                        Consegna
                                    </label>
                                </div>
                                <div class="CustomSelectionItem">
                                    <select class="col-sm-12 SelectionItem" id="country" name="Consegna">
                                        <option> @Model.Consegna</option>
                                        <option> DA CONCORDARE </option>
                                        <option> EFFETTUATO </option>
                                        <option> NON EFFETTUATO </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>


                    <br />

                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-6">
                                <div>
                                    <label class="col-sm-12">
                                        Nota d'apertura
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="text" name="NomeApertura" value="@Model.NotaApertura">
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div>
                                    <label class="col-sm-12">
                                        Nota di chiusura
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="text" name="NotaChiusura" value="@Model.NotaChiusura">
                                </div>
                            </div>
                        </div>
                    </div>

                    <br />
                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-6">
                                <div>
                                    <label class="col-sm-12">
                                        Cartella
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="text" name="Cartella" value="@Model.Cartella">
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div>
                                    <label class="col-sm-12">
                                        Numero commissione
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="number" name="NumeroCommissione" value="@Model.NumeroCommissione">
                                </div>
                            </div>
                        </div>
                    </div>


                    <br />
                    <div class="form-group">
                        <div class="row">
                            <div class="col-sm-6">
                                <div>
                                    <label class="col-sm-12">
                                        Data inizio lavori
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="text" name="DataInzioLavori" value="@Model.DataInizioLavori">
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div>
                                    <label class="col-sm-12">
                                        Referenza
                                    </label>
                                </div>
                                <div>
                                    <input class="col-sm-12" type="text" name="Riferimento" value="@Model.Referenza">
                                </div>
                            </div>
                        </div>
                    </div>

                    <br />


                    <div class="form-group">
                        <div class="row">
                            <div class="col-md-6">
                                <div>
                                    <label class="col-sm-12">
                                        Note Andamento
                                    </label>
                                </div>
                                <div>
                                    <textarea class="col-sm-12 TextArea" type="text" name="NoteAndamento" ></textarea>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div>
                                    <label class="col-sm-12">Totale(€)</label>
                                </div>
                                <div>
                                    <input id="Totale" class="col-sm-12 ImportantData Inp chg" type="number" min="0" name="TotaleArticoliListino" value="@Model.TotaleArticoliListino">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div>
                                    <label class="col-sm-12">Totale scontato(€)</label>
                                </div>
                                <div>
                                    <input id="Destination" style="text-align:center;" class="col-sm-12 ImportantData Dest " type="text" readonly min="0" name="ImportoTotaleScontato" value="@Model.ImportoTotaleScontato">
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div>
                                    <label class="col-sm-12">Sconto (%)</label>
                                </div>
                                <div>
                                    <input id="Sconto" class="col-sm-12 ImportantData chg" type="number" min="0" max="100" name="ScontoGenerale" value="@Model.ScontoGenerale">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
             }
    </div>
        
    
            

<style>
           
        

</style>

<script>

    
    //$("#StartPoint").on("input", function (e) {
    //    var b = $(this);
    //    CalculateDataUsingCustomInput($(this), CalculationType.PERCENTAGE);
    //});
    $( "#Sconto").on("input", function (e) {
        SetData();
    });

    $( "#Totale").on("input", function (e) {
        SetData();
    });

    function SetData() {
        var Data = [];
        var Sconto = $('#Sconto')[0].value;
        var Totale = $('#Totale')[0].value;
        Data.push(Sconto);
        Data.push(Totale);
        Destination = $('#Destination')[0];
        var Result = CalculateDataUsingCustomInput(Data, CalculationType.PERCENTAGE);
        $(Destination).val(Result);
    }


    $(document).on('submit', '#Form_', function (e) {
        
    });
    

    $("#genera").click(function () {

        var detailsPreventive = $('#Form_').serializeFormJSON();
        GeneratePdfFromElementId($('#Form_'));

    });


</script>




